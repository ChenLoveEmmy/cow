<!DOCTYPE html>
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
    <meta charset="utf-8"/>
    <title>随机抽取名单系统</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="Preview page of Metronic Admin Theme #1 for " name="description"/>
    <meta content="" name="author"/>
    <#include "common/cssCommon.html" />
    <#include "common/jsCommon.html" />

    <script type="text/javascript">

        $(document).ready(function () {

            $("#sub").click(function () {

                if ($("#caseFile").val() == "") {
                    return alert("先上传文件");
                }

            var formData = new FormData($('#inputForm')[0]);
                $.ajax({
                    url : "/checkController/checkExcel",
                    type : 'POST',
                    data : formData,
                    async : true,
                    cache : false,
                    contentType : false,
                    processData : false,
                    dataType: 'json',
                    success : function(data) {
                        console.log(data)
                        alert(data.msg);
                        if(data.ret == 0){
                            var personList = data.entityList;
                            console.log(personList);
                            $("#personList tbody").text("");
                            $("#caseFile").val("");
                            personList.forEach(function (o,j) {
                                console.log(o);
                                console.log(j);
                                var str = "<tr>" +
                                    "<td>"+o.name+"</td>"+
                                    "<td>"+o.specialty+"</td>"+
                                    "<td>"+o.phone+"</td>"+
                                    "<td>"+o.adds+"</td>"+
                                    "<td>"+o.remark+"</td>";
                                $("#personList tbody").append(str);
                            })

                            var myDate = new Date;
                            var year = myDate.getFullYear(); //获取当前年
                            var mon = myDate.getMonth() + 1; //获取当前月
                            var date = myDate.getDate(); //获取当前日
                            var h = myDate.getHours();//获取当前小时数(0-23)
                            var m = myDate.getMinutes();//获取当前分钟数(0-59)
                            var s = myDate.getSeconds();//获取当前秒
                            var week = myDate.getDay();
                            var weeks = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
                            console.log(year, mon, date, weeks[week])
                            $("#text").html("抽取时间: "+year + "年" + mon + "月" + date + "日  " + h+":"+m+":"+s);

                        }

                    },
                    error : function(data) {
                        alert("请检查文件是否正确");
                    }
                })
            })
        })
    </script>
</head>
<body>
<div class="row">
    <div class="col-lg-12 col-xs-12 col-sm-12">
        <div class="portlet light ">
            <div class="portlet-title">
                <h1>随机抽取名单系统</h1>
            </div>
            <div class="portlet-title">
                <form id="inputForm" class="form form-group">
                    <div class="col-sm-12 col-lg-12 col-xs-12 form-group">
                        <a href="/excelDemo/personExcel.xlsx" download="评标模板.xlsx">下载文件模板</a>
                    </div>
                    <div class="col-sm-12 col-lg-12 col-xs-12 form-group">
                        <input type="file" id="caseFile" class="file blue" name="caseFile" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel
                        ">
                    </div>
                    <div class="col-sm-12 col-lg-12 col-xs-12 form-group">
                        <input type="button" class="btn blue btn-blue" id="sub" value="抽取"/>
                        <span style="color: red"> &emsp;  注：请先下载模板，严格按照模板上传文件，至少上传姓名</span>
                    </div>
                </form>
            </div>
            <div class="portlet-title">
                <div class="col-lg-12 col-sm-12 col-xs-12">
                    <div id="text" style="text-align: center; color: #0a6aa1">

                    </div>
                    <table id="personList" class="table table-hover table-container table-download">
                        <thead>
                        <tr>
                            <th>姓名</th>
                            <th>专业</th>
                            <th>电话</th>
                            <th>单位</th>
                            <th>备注</th>
                        </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

</body>
</html>